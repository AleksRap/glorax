"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}document.addEventListener("DOMContentLoaded",function(){var e=document.documentElement.clientWidth,o=document.querySelectorAll(".nav__item"),i=document.querySelectorAll(".nav__mobile-item"),s=["projects","about-us","map","rooms"].map(function(e){var t=document.querySelector(".header").clientHeight;return window.pageYOffset+document.querySelector("#".concat(e)).getBoundingClientRect().top-t});window.addEventListener("scroll",function(){for(var e=document.documentElement.scrollTop,t=null,n=0;n<s.length;n++){var r=s[n+1]||document.body.scrollHeight;if(e>=s[n]&&e<r){t=n;break}}for(var a=0;a<o.length;a++)o[a].classList.remove("select"),i[a].classList.remove("select");null!==t&&(o[t].classList.add("select"),i[t].classList.add("select"))});var t=document.querySelector('[data-mobile-nav="open"]'),n=document.querySelector('[data-mobile-nav="close"]'),r=document.querySelector(".nav__callback-btn_mobile"),a=document.querySelector(".nav__mobile-list-wrap");t.addEventListener("click",function(){a.classList.add("open")}),n.addEventListener("click",function(){a.classList.remove("open")}),r.addEventListener("click",function(){a.classList.remove("open")}),a.addEventListener("click",function(e){e.target.closest(".nav__mobile-link")&&a.classList.remove("open")}),window.addEventListener("click",function(e){var t=e.target.closest(".nav__mobile-list-wrap"),n=e.target.closest('[data-mobile-nav="open"]');t||n||a.classList.remove("open")}),new Modal({idModal:"modal-callback",selectorBtnOpen:"[data-open-modal]"}),e<1e3&&document.querySelector(".projects__cards").addEventListener("click",function(e){var t,n=e.target.closest(".card-real-estate");n&&(t=n.querySelector('[data-btn-card="toggle"]'),n.classList.toggle("open"),t.classList.toggle("open"))});var c=document.querySelector(".header"),l=c.clientHeight;function d(){window.pageYOffset>l?c.classList.add("header_color"):c.classList.remove("header_color")}d(),window.addEventListener("scroll",d),new Swiper(".main-screen__swiper-container",{slidesPerView:1,initialSlide:0,loop:!0,autoplay:{delay:6e3},speed:1500,pagination:{el:".swiper-pagination",clickable:!0},preloadImages:!1,lazy:!0,loadOnTransitionStart:!0});var u=document.querySelectorAll('[href^="#"]');u.length&&u.forEach(function(e){e.addEventListener("click",function(e){e.preventDefault();var i=window.pageYOffset,t=e.target.href.replace(/[^#]*(.*)/,"$1"),s=document.querySelector(t).getBoundingClientRect().top,c=null;requestAnimationFrame(function e(t){null===c&&(c=t);var n=t-c;var r=document.querySelector(".header").clientHeight;var a=i+s-r;var o=s<0?Math.max(i-n/.3,a):Math.min(i+n/.3,a);window.scrollTo(0,o);o!==a&&requestAnimationFrame(e)})})});var _=document.querySelector('[data-input="tel"]');_.addEventListener("input",mask),_.addEventListener("focus",mask),_.addEventListener("blur",mask),document.querySelectorAll(".card-tower").forEach(function(e){return new Layouts(e)}),document.querySelectorAll(".card-tower__img").forEach(function(e){return new GalleryCards(e)})});var ManagementEvents=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"addEventToArr",value:function(e){return e.arr.push({el:e.el,event:e.event,fn:e.fn}),e.el.addEventListener(e.event,e.fn),!0}},{key:"removeEvents",value:function(e){return e.forEach(function(e){e.el.removeEventListener(e.event,e.fn)}),e.splice(0,e.length),!0}}]),e}(),Modal=function(){function t(e){_classCallCheck(this,t),this.arrEvents=[],this._modal=document.getElementById(e.idModal),this._modalWindow=this._modal.querySelector('[data-modal="window"]'),this._btnsOpen=document.querySelectorAll(e.selectorBtnOpen),this._btnClose=this._modal.querySelector('[data-modal="close"]'),this.bind()}return _createClass(t,[{key:"open",value:function(){this._modal.classList.add("modal_open"),this._modalWindow.classList.add("modal__window_open")}},{key:"close",value:function(){this._modal.classList.remove("modal_open"),this._modalWindow.classList.remove("modal__window_open")}},{key:"bind",value:function(){var t=this;this._btnsOpen.forEach(function(e){ManagementEvents.addEventToArr({arr:t.arrEvents,el:e,event:"click",fn:function(){return t.open()}})}),ManagementEvents.addEventToArr({arr:this.arrEvents,el:this._modal,event:"click",fn:function(e){return!e.target.closest("[data-modal=window]")&&t.close()}}),ManagementEvents.addEventToArr({arr:this.arrEvents,el:this._btnClose,event:"click",fn:function(){return t.close()}})}},{key:"destroy",value:function(){ManagementEvents.removeEvents(this.arrEvents),this._modal.remove()}}]),t}();function setCursorPosition(e,t){var n;t.focus(),t.setSelectionRange?t.setSelectionRange(e,e):t.createTextRange&&((n=t.createTextRange()).collapse(!0),n.moveEnd("character",e),n.moveStart("character",e),n.select())}function mask(e){var t="+7 (___) ___ ____",n=0,r=t.replace(/\D/g,""),a=this.value.replace(/\D/g,"");r.length>=a.length&&(a=r),this.value=t.replace(/./g,function(e){return/[_\d]/.test(e)&&n<a.length?a.charAt(n++):n>=a.length?"":e}),"blur"===e.type?2===this.value.length&&(this.value=""):setCursorPosition(this.value.length,this)}var Layouts=function(){function t(e){_classCallCheck(this,t),this._wrap=e,this._allCards=document.querySelectorAll(".card-tower"),this._body=this._wrap.querySelector(".card-tower__body"),this._allBlock=this._wrap.querySelectorAll("[data-block]"),this._btnAbout=this._wrap.querySelector('[data-btn="about"]'),this._btnLayouts=this._wrap.querySelector('[data-btn="layouts"]'),this._btnClose=this._wrap.querySelector('[data-btn="close"]'),this._about=this._wrap.querySelector(".card-tower__general-information"),this._layouts=this._wrap.querySelector(".card-tower__layouts"),this._rowsWrap=this._wrap.querySelector(".card-tower__table-row-wrap"),this._images=this._wrap.querySelector(".card-tower__table-img"),this._bind()}return _createClass(t,[{key:"showBlock",value:function(e){switch(this._closeAllCards(),this._body.removeAttribute("hidden"),this._allBlock.forEach(function(e){return e.setAttribute("hidden",!0)}),e.removeAttribute("hidden"),e){case this._about:this._btnAbout.classList.add("card-tower__btn_active"),this._btnLayouts.classList.remove("card-tower__btn_active");break;default:this._btnLayouts.classList.add("card-tower__btn_active"),this._btnAbout.classList.remove("card-tower__btn_active")}}},{key:"hideBlock",value:function(){this._body.setAttribute("hidden",!0),this._allBlock.forEach(function(e){return e.removeAttribute("hidden")}),this._btnAbout.classList.remove("card-tower__btn_active"),this._btnLayouts.classList.remove("card-tower__btn_active")}},{key:"changeLayout",value:function(e){var n,r=e.target.closest(".card-tower__table-row");r&&(_toConsumableArray(this._rowsWrap.children).forEach(function(e,t){e===r&&(n=t),e.classList.remove("active")}),r.classList.add("active"),_toConsumableArray(this._images.children).forEach(function(e,t){t===n?e.removeAttribute("hidden"):e.setAttribute("hidden",!0)}))}},{key:"_closeAllCards",value:function(){this._allCards.forEach(function(e){e.querySelector(".card-tower__body").setAttribute("hidden",!0),e.querySelectorAll(".card-tower__btn").forEach(function(e){return e.classList.remove("card-tower__btn_active")})})}},{key:"_toggleBlock",value:function(e,t){e.target.closest(".card-tower__btn").classList.contains("card-tower__btn_active")?this.hideBlock():this.showBlock(t)}},{key:"_bind",value:function(){var t=this;this._btnAbout.addEventListener("click",function(e){return t._toggleBlock(e,t._about)}),this._btnLayouts.addEventListener("click",function(e){return t._toggleBlock(e,t._layouts)}),this._btnClose.addEventListener("click",function(){return t.hideBlock()}),this._rowsWrap.addEventListener("mouseover",function(e){return t.changeLayout(e)})}}]),t}(),GalleryCards=function(){function t(e){_classCallCheck(this,t),this._gallery=e,this._render(),this._bind(),refreshFsLightbox()}return _createClass(t,[{key:"_render",value:function(){this._gallery.insertAdjacentHTML("beforeend",this._generateTemplate())}},{key:"_bind",value:function(){var t=this,a=this._gallery.querySelector(".card-tower__sections");a.addEventListener("mouseover",function(e){var n,r=e.target.closest(".card-tower__section");_toConsumableArray(a.children).forEach(function(e,t){r===e&&(n=t),e.classList.remove("active")}),_toConsumableArray(t._gallery.children).forEach(function(e){return e.classList.remove("active")}),r.classList.add("active"),_toConsumableArray(t._gallery.children)[n].classList.add("active")})}},{key:"_generateTemplate",value:function(){var e=this._gallery.childElementCount,t=[];return _toConsumableArray(this._gallery.children).forEach(function(e){return t.push(e.src.split(location.origin).join(""))}),'\n      <div class="card-tower__sections">\n        '.concat(this._getTemplateSection(e,t),"\n      </div>\n    ")}},{key:"_getTemplateSection",value:function(e,t){for(var n="",r=0;r<e;r++)n+='<a class="card-tower__section" href="'.concat(t[r],'" data-fslightbox="gallery"></a>');return n}}]),t}();ymaps.ready(function(){var u=new ymaps.Map("map-yandex",{center:[59.93,30.31],zoom:11}),e=JSON.parse(document.getElementById("json").textContent);e.forEach(function(e){var t,n,r,a,o,i=e.name,s=e.coordinates,c=e.address,l=e.img,d=e.id;u.geoObjects.add(new ymaps.Placemark(s,{hintLayout:i,balloonContentHeader:(r=l,a=d,'\n    <a class="card-map__header" href="#'.concat(o,'">\n      <img src="').concat(r,'" alt="').concat(a,'">\n    </a>\n  ')),balloonContentFooter:(t=i,n=c,'\n    <a class="card-map__footer" href="#'.concat(d,'">\n      <h2 class="card-map__title">').concat(t,'</h2>\n      <p class="card-map__address">').concat(n,"</p>\n    </a>\n  "))},{iconLayout:"default#imageWithContent",iconImageHref:"images/other/point-map.png",iconImageSize:[34,43],iconImageOffset:[-17,-43],iconContentOffset:[17,50]}))})});
//# sourceMappingURL=script.min.js.map
